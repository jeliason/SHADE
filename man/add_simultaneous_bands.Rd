% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/credible_bands.R
\name{add_simultaneous_bands}
\alias{add_simultaneous_bands}
\title{Add Simultaneous Credible Bands to SIC Posterior Data}
\usage{
add_simultaneous_bands(
  sic_data,
  distance_col = "distance",
  sic_cols = NULL,
  alpha = 0.05,
  keep_rvar = FALSE
)
}
\arguments{
\item{sic_data}{Data frame containing rvar columns (from posterior package)
representing SIC posteriors. Must have a column identifying distance coordinates.}

\item{distance_col}{Name of the column containing distance values (default: "distance").}

\item{sic_cols}{Character vector of rvar column names to compute bands for.
If NULL (default), processes all rvar columns except the distance column.}

\item{alpha}{Significance level (default 0.05 for 95% simultaneous bands).}

\item{keep_rvar}{Logical; if TRUE, keeps the original rvar column. Default FALSE.}
}
\value{
A data frame with the original data plus columns for each SIC:
  \item{<sic>_mean}{Posterior mean}
  \item{<sic>_lower}{Simultaneous lower bound}
  \item{<sic>_upper}{Simultaneous upper bound}
}
\description{
Computes simultaneous credible bands that control the family-wise error rate
across all distances. This ensures the entire curve falls within the band with
(1-alpha)% probability, rather than just pointwise coverage.
}
\details{
The algorithm:
1. Extracts mean and SD at each distance for each rvar column
2. Standardizes posterior deviations: (draw - mean) / SD
3. Finds maximum absolute deviation across all distances for each draw
4. Uses the (1-alpha) quantile of these maxima as the critical value
5. Constructs bands: mean ± critical_value × SD

Simultaneous bands are wider than pointwise bands but provide stronger guarantees:
the entire curve is contained with (1-alpha)% probability.
}
\examples{
\dontrun{
library(dplyr)
library(posterior)

# Compute SIC posteriors
sics <- compute_sic_posterior(fit, prep, level = "group")

# Add simultaneous bands
sics_with_bands <- sics \%>\%
  add_simultaneous_bands(alpha = 0.1)

# Plot
ggplot(sics_with_bands, aes(x = distance, y = sic_mean)) +
  geom_ribbon(aes(ymin = sic_lower, ymax = sic_upper), alpha = 0.2) +
  geom_line() +
  facet_wrap(~source)
}

}
