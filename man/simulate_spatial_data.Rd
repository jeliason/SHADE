% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_utils.R
\name{simulate_spatial_data}
\alias{simulate_spatial_data}
\title{Simulate Spatial Data with Directional Associations}
\usage{
simulate_spatial_data(
  n_images = 4,
  n_patients = 2,
  n_groups = 2,
  cell_types = c("tumor", "immune", "stroma"),
  target_type = NULL,
  window_size = 1500,
  sigma_beta_global = 0.5,
  sigma_beta_indiv = 0.1,
  sigma_beta_local = 0.1,
  scale_sigmas = 1,
  n_cells_per_type = 150,
  n_basis_functions = 3,
  max_dist = 75,
  basis_function_sigma = 15,
  seed = 2025,
  verbose = FALSE
)
}
\arguments{
\item{n_images}{Total number of images to simulate.}

\item{n_patients}{Number of patients.}

\item{n_groups}{Number of patient groups.}

\item{cell_types}{Character vector of cell type names. The last type is treated as the target.}

\item{target_type}{Character string specifying which cell type is the target (default: last type).}

\item{window_size}{Size of the square observation window (default: 1500).}

\item{n_cells_per_type}{Number of cells per type per image (default: 150).}

\item{n_basis_functions}{Number of RBF basis functions (default: 3).}

\item{max_dist}{Maximum distance for basis functions (default: 75).}

\item{basis_function_sigma}{Spread of basis functions (default: 15).}

\item{seed}{Random seed for reproducibility (default: 2025).}

\item{verbose}{logical}
}
\value{
A list with elements:
\describe{
  \item{data}{A tibble with columns: x, y, cell_type, image_id}
  \item{true_params}{A list containing the true simulation parameters for comparison}
}
}
\description{
Generates simulated spatial point patterns with biologically plausible asymmetric
spatial associations between cell types. The function creates a hierarchical dataset
with images nested within patients and patients within groups.
}
