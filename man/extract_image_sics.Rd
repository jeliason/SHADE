% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sic_extraction.R
\name{extract_image_sics}
\alias{extract_image_sics}
\title{Extract Image-Level Spatial Interaction Curves}
\usage{
extract_image_sics(
  fit,
  prep,
  indices = NULL,
  distance_seq = seq(0, 100, by = 1),
  sources = NULL,
  bands = c("none", "pointwise", "simultaneous"),
  alpha = 0.05,
  keep_rvar = FALSE
)
}
\arguments{
\item{fit}{A CmdStan model fit object returned by `run_SHADE_model()`.}

\item{prep}{The preprocessing object returned by `prepare_spatial_model_data()`.}

\item{indices}{Optional integer vector specifying which images/patients/groups to extract.
If NULL (default), extracts all available at the specified level.}

\item{distance_seq}{Numeric vector of distances at which to evaluate SICs.
Default: seq(0, 100, by = 1).}

\item{sources}{Optional character vector of source cell types to extract.
If NULL (default), extracts all source types.}

\item{bands}{Type of credible bands to add: "simultaneous", "pointwise", or "none".
Default is "simultaneous".}

\item{alpha}{Significance level for credible bands (default: 0.05).}

\item{keep_rvar}{Logical; if TRUE and bands != "none", keeps the rvar column.
Default FALSE.}
}
\value{
A tibble with distance, source, level information, and either rvar or
  summarized columns depending on `bands` argument.
}
\description{
Convenience wrapper around `compute_sic_posterior()` that extracts image-level
SICs. Note that image-level estimates are typically noisy, so credible bands
default to "none".
}
\examples{
\dontrun{
# Extract for all images (no bands by default due to noise)
sics <- extract_image_sics(fit, prep, bands = "none")

# Extract for specific images
sics <- extract_image_sics(fit, prep, indices = c(1, 2, 3))
}

}
