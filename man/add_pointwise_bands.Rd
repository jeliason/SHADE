% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/credible_bands.R
\name{add_pointwise_bands}
\alias{add_pointwise_bands}
\title{Add Pointwise Credible Bands to SIC Posterior Data}
\usage{
add_pointwise_bands(
  sic_data,
  distance_col = "distance",
  sic_cols = NULL,
  alpha = 0.05,
  keep_rvar = FALSE
)
}
\arguments{
\item{sic_data}{Data frame containing rvar columns (from posterior package)
representing SIC posteriors. Must have a column identifying distance coordinates.}

\item{distance_col}{Name of the column containing distance values (default: "distance").}

\item{sic_cols}{Character vector of rvar column names to compute bands for.
If NULL (default), processes all rvar columns except the distance column.}

\item{alpha}{Significance level (default 0.05 for 95% pointwise bands).}

\item{keep_rvar}{Logical; if TRUE, keeps the original rvar column. Default FALSE.}
}
\value{
A data frame with the original data plus columns for each SIC:
  \item{<sic>_mean}{Posterior mean}
  \item{<sic>_lower}{Pointwise lower bound}
  \item{<sic>_upper}{Pointwise upper bound}
}
\description{
Computes pointwise credible bands using simple quantiles at each distance.
Unlike simultaneous bands, these only guarantee pointwise coverage - each
individual point has (1-alpha) probability of being in the band, but the
entire curve may not be contained.
}
\details{
The algorithm:
1. Extracts mean at each distance for each rvar column
2. Computes (alpha/2) and (1-alpha/2) quantiles at each distance independently
3. Returns mean with quantile-based bounds

Pointwise bands are narrower than simultaneous bands but provide weaker guarantees:
each individual distance has (1-alpha)% coverage, but multiple testing issues arise.
}
\examples{
\dontrun{
library(dplyr)
library(posterior)

# Compute SIC posteriors
sics <- compute_sic_posterior(fit, prep, level = "group")

# Add pointwise bands
sics_with_bands <- sics \%>\%
  add_pointwise_bands(alpha = 0.05)

# Compare with simultaneous bands
sics_simul <- add_simultaneous_bands(sics, alpha = 0.05)
}

}
